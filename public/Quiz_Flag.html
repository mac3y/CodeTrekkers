<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300&display=swap" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="https://img.icons8.com/?size=100&id=KDH7zOWVcvjU&format=png&color=000000">
  <title>Flag Quiz</title>
  <style>
  
  		*{
           font-family: 'Nunito', sans-serif;
  		   font-weight: 300;
           letter-spacing: 0.1em;
        }
        
        
      body {
        font-family: 'Nunito', sans-serif;
        background-color: #f5ebdb;
        color: #0F0E47;
        text-align: center;
        padding: 0;
        margin: 0;
      }
  
      .quiz-container {
        background-color: rgba(255, 255, 255, 0.5);
        padding: 20px;
        border-radius: 20px;
        max-width: 500px;

        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        margin: 125px auto 125px auto;
      }

     

      #flag {
        max-width: 200px;
        margin: 20px auto;
        border: 1px solid #4CAF50;
      }

      #options button {
        display: block;
        margin: 10px auto;
        padding: 10px;
        background-color: #81a079;
        color: #fff;
        border: none;
        border-radius: 10px;
        width: 80%;
        cursor: pointer;
      }

      #options button:hover {
        background-color: #81a079;
      }

      #nextBtn, #restartBtn {
        margin-top: 20px;
        padding: 10px 20px;
        background-color: #81a079;
        color: #fff;
        border: none;
        border-radius: 10px;
        cursor: pointer;
      }

      #continentSelect {
        margin-bottom: 20px;
      }

      #continentSelect select, #continentSelect button {
        padding: 10px;
        margin-top: 10px;
        font-size: 16px;
        border-radius: 10px;
        border: none;
      }

      #continentSelect button {
        background-color: #81a079;
        color: white;
        cursor: pointer;
      }

      #continentSelect {
        margin-bottom: 20px;
      }

      #continentSelect select,
      #continentSelect button {
        padding: 10px;
        font-size: 16px;
        border-radius: 10px;
        border: none;
        margin-top: 10px;
      }

      #continentSelect button {
        background-color: #81a079;
        color: white;
        cursor: pointer;
      }

      table, th, td {
        border: 1px solid #81a079;
        padding: 10px;
        text-align: center;
      }

      th {
        background-color: #81a079;
        color: white;
      }

      #progress {
        font-size: 18px;
        margin-bottom: 15px;
        font-weight: bold;
      }

      #progressBar {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        font-weight: bold;
        font-size: 16px;
      }

      #progressBar .left {
        text-align: left;
      }

      #progressBar .right {
        text-align: right;
      }

      #logoutBtn {
        padding: 8px 16px;
        background-color: #196633;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
        transition: background-color 0.3s ease;
      }

      #logoutBtn:hover {
        background-color: #4CAF50;
      }

      #loginBtn {
        padding: 8px 16px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
        transition: background-color 0.3s ease;
      }

      #loginBtn:hover {
        background-color: #4CAF50;
      }

      .navbar {
        background-color: #66bb6a;
        color: white;
        padding: 10px 20px;
        margin: 0%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-radius: 0 0 0 0;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .nav-left {
        font-size: 20px;
      }

      .nav-right {
        display: flex;
        align-items: center;
      }

      .nav-right a {
        color: white;
        margin-left: 20px;
        text-decoration: none;
        font-weight: bold;
      }

      .nav-right a:hover {
        text-decoration: underline;
      }

      .nav-right button {
        margin-left: 20px; 

      }

       footer{
          text-align: center; 	
          padding: 15px 0; 
          background-color: #66bb6a; 
          color: white; 
          margin-top: 20px;
          letter-spacing: .1em;
       }
    

  </style>
</head>


<body>
  <header>
    <nav class="navbar">
      <div class="nav-left">
        <strong>CodeTreckkers</strong>
      </div>
      <div class="nav-right">
        <a href="index.html">Home</a>
        <a href="country-viewer.html">Country Info</a>
        <a href="currency-converter.html">Currency Converter</a>
        <button id="loginBtn" style="display: block;">Login</button>
        <button id="logoutBtn" style="display: none;">Logout</button>
      </div>
    </nav>
  </header>
  <div class="quiz-container">
  <img src="https://img.icons8.com/?size=100&id=osWiBOYLPXb2&format=png&color=000000" alt="Flag Quiz">
    <h1>Flag Quiz</h1>

    <div id="continentSelect">
      <p>Select a continent to begin:</p>
      <select id="continentDropdown">
        <option value="">-- Choose Continent --</option>
        <option value="All">All Continents</option>
        <option value="Africa">Africa</option>
        <option value="Asia">Asia</option>
        <option value="Europe">Europe</option>
        <option value="North America">North America</option>
        <option value="South America">South America</option>
        <option value="Oceania">Oceania</option>
      </select>
      <button id="startBtn">Start Quiz</button>
    </div>

    <div id="quizSection" style="display:none;">
      <div id="progressBar">
        <div id="questionNumber" class="left"></div>
        <div id="currentScore" class="right"></div>
      </div>
      <div id="question"></div>
      <img id="flag" src="" alt="Flag" style="display: none;">
      <div id="options"></div>
      <div id="feedback"></div>
      <button id="nextBtn" disabled>Next</button>
      <div id="scoreDisplay"></div>
      <button id="restartBtn" style="display:none;">Restart</button>
    </div>

    <script>
      const logoutBtn = document.getElementById('logoutBtn');
  
      logoutBtn.addEventListener('click', () => {
        localStorage.removeItem('currentUser');
        window.location.href = 'login.html';
      });
    </script>


  <script type="module" src="./auth.js"></script>

  </div>

  <script>
    const questionEl = document.getElementById("question");
    const flagEl = document.getElementById("flag");
    const optionsEl = document.getElementById("options");
    const feedbackEl = document.getElementById("feedback");
    const nextBtn = document.getElementById("nextBtn");
    const restartBtn = document.getElementById("restartBtn");
    const scoreDisplay = document.getElementById("scoreDisplay");
    const quizSection = document.getElementById("quizSection");
    const progressEl = document.getElementById("progress");
    const questionNumberEl = document.getElementById("questionNumber");
    const currentScoreEl = document.getElementById("currentScore");
    
    const continentSelect = document.getElementById("continentSelect");
    const continentDropdown = document.getElementById("continentDropdown");
    const startBtn = document.getElementById("startBtn");
    
    let countries = [];
    let currentQuestion = {};
    let score = 0;
    let totalQuestions = 10;
    let questionCount = 0;
    let questionPool = [];
    let reviewLog = [];
    
    startBtn.addEventListener("click", () => {
      const selectedContinent = continentDropdown.value;
      if (!selectedContinent) {
        alert("Please select a continent.");
        return;
      }
      fetchCountries(selectedContinent);
    });
    
    async function fetchCountries(continent) {
  const res = await fetch("https://restcountries.com/v3.1/all?fields=name,flags,region,subregion");
  const data = await res.json();

  if (continent === "All") {
    countries = data.filter(c => c.name && c.flags);
  } else if (continent === "North America") {
    countries = data.filter(c =>
      ["Northern America", "Central America", "Caribbean"].includes(c.subregion)
    );
  } else if (continent === "South America") {
    countries = data.filter(c => c.subregion === "South America");
  } else {
    countries = data.filter(c => c.region === continent);
  }

  if (countries.length === 0) {
    alert("No countries found for selected continent.");
    return;
  }

  continentSelect.style.display = "none";
  quizSection.style.display = "block";
  startQuiz();
}
    
    function startQuiz() {
      score = 0;
      questionCount = 0;
      reviewLog = [];
      questionPool = [...countries];
      shuffleArray(questionPool);
      scoreDisplay.innerText = "";
      nextBtn.disabled = true;
      nextBtn.style.display = "inline-block";
      restartBtn.style.display = "none";
      loadQuestion();
    }
    
    function loadQuestion() {
      questionNumberEl.innerText = `(${questionCount + 1} of ${totalQuestions})`;
      currentScoreEl.innerText = `(Score: ${score})`;
      nextBtn.disabled = true;
      feedbackEl.innerText = "";
      optionsEl.innerHTML = "";
      flagEl.style.display = "none";
    
      const correct = questionPool.pop(); // grab and remove next question
      if (!correct) {
        endQuiz();
        return;
      }
    
      questionCount++;
      currentQuestion = { correct };
    
      // pick 3 wrong options that are not the correct one
      const incorrect = countries.filter(c => c.name.common !== correct.name.common);
      shuffleArray(incorrect);
      const choices = [correct, ...incorrect.slice(0, 3)];
    
      shuffleArray(choices);
    
      questionEl.innerText = "Which country does this flag belong to?";
      flagEl.src = correct.flags.svg;
      flagEl.style.display = "block";
    
      choices.forEach(c => createOptionButton(c.name.common, c.name.common));
    }
    
    function createOptionButton(label, countryName) {
      const btn = document.createElement("button");
      btn.innerText = label;
      btn.onclick = () => checkAnswer(countryName);
      optionsEl.appendChild(btn);
    }
    
    function checkAnswer(selectedName) {
      const correctName = currentQuestion.correct.name.common;
      const buttons = optionsEl.querySelectorAll("button");
    
      buttons.forEach(btn => btn.disabled = true);
    
      const isCorrect = selectedName === correctName;
    
      if (isCorrect) {
        score++;
        feedbackEl.innerText = "✅ Correct!";
      } else {
        feedbackEl.innerText = `❌ Wrong! Correct answer: ${correctName}`;
      }
    
      // ✅ Update score display after scoring
      currentScoreEl.innerText = `(Score: ${score})`;
    
      reviewLog.push({
        flag: currentQuestion.correct.flags.svg,
        yourAnswer: selectedName,
        correctAnswer: correctName,
        isCorrect: isCorrect
      });
    
      nextBtn.disabled = false;
    }
    
    function nextQuestion() {
      if (questionCount < totalQuestions) {
        loadQuestion();
      } else {
        endQuiz();
      }
    }
    
    function endQuiz() {
      questionEl.innerText = "Quiz Complete!";
      flagEl.style.display = "none";
      optionsEl.innerHTML = "";
      feedbackEl.innerText = `Your score: ${score} / ${totalQuestions}`;
      scoreDisplay.innerText = "";
      nextBtn.disabled = true;
      nextBtn.style.display = "none";
      restartBtn.style.display = "inline-block";
    
      // Create review table
      const table = document.createElement("table");
      table.style.margin = "20px auto";
      table.style.borderCollapse = "collapse";
      table.style.width = "100%";
      table.innerHTML = `
        <tr>
          <th>Flag</th>
          <th>Your Answer</th>
          <th>Correct Answer</th>
        </tr>
      `;
    
      reviewLog.forEach(entry => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td><img src="${entry.flag}" style="width: 50px; border: 1px solid #0F0E47;"></td>
          <td style="color: ${entry.isCorrect ? 'green' : 'red'}">${entry.yourAnswer}</td>
          <td>${entry.correctAnswer}</td>
        `;
        table.appendChild(row);
      });
    
      optionsEl.appendChild(table);
    }
    
    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }
    
    nextBtn.addEventListener("click", nextQuestion);
    restartBtn.addEventListener("click", () => {
      quizSection.style.display = "none";
      continentSelect.style.display = "block";
    });
    </script>
    </div>
    <footer>
      <p>2025 CodeTreckkers. All rights reserved.</p>
    </footer>
</body>
</html>

